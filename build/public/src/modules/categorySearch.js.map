{"version":3,"sources":["public/src/modules/categorySearch.js"],"names":["define","categorySearch","init","el","utils","isTouchDevice","searchEl","find","length","categoryEls","on","revealParents","cid","parentCid","attr","removeClass","revealChildren","els","each","index","$el","$","updateList","val","toLowerCase","noMatch","cids","liEl","this","isMatch","indexOf","push","toggleClass","css","font-weight","forEach","addClass","ev","preventDefault","stopPropagation","focus","off"],"mappings":"AAAA,aAEAA,OAAO,iBAAkB,WACxB,IAAIC,KAEJA,EAAeC,KAAO,SAAUC,GAC/B,GAAIC,MAAMC,gBAAiB,CAC1B,OAED,IAAIC,EAAWH,EAAGI,KAAK,0CACvB,IAAKD,EAASE,OAAQ,CACrB,OAED,IAAIC,EAAcN,EAAGI,KAAK,0CAC1BJ,EAAGO,GAAG,mBAAoB,WACzB,SAASC,EAAcC,GACtB,IAAIC,EAAYV,EAAGI,KAAK,0CAA4CK,EAAM,MAAME,KAAK,mBACrF,GAAID,EAAW,CACdV,EAAGI,KAAK,0CAA4CM,EAAY,MAAME,YAAY,UAClFJ,EAAcE,IAIhB,SAASG,EAAeJ,GACvB,IAAIK,EAAMd,EAAGI,KAAK,iDAAmDK,EAAM,MAC3EK,EAAIC,KAAK,SAAUC,EAAOhB,GACzB,IAAIiB,EAAMC,EAAElB,GACZiB,EAAIL,YAAY,UAChBC,EAAeI,EAAIN,KAAK,eAI1B,SAASQ,IACR,IAAIC,EAAMjB,EAASC,KAAK,SAASgB,MAAMC,cACvC,IAAIC,EAAU,KACd,IAAIC,KACJjB,EAAYS,KAAK,WAChB,IAAIS,EAAON,EAAEO,MACb,IAAIC,EAAUF,EAAKb,KAAK,aAAaU,cAAcM,QAAQP,MAAU,EACrE,GAAIE,GAAWI,EAAS,CACvBJ,EAAU,MAEX,GAAII,GAAWN,EAAK,CACnBG,EAAKK,KAAKJ,EAAKb,KAAK,aAErBa,EAAKK,YAAY,UAAWH,GAAStB,KAAK,iCAAiC0B,KAAMC,cAAeX,GAAOM,EAAU,OAAS,aAG3HH,EAAKS,QAAQ,SAAUvB,GACtBD,EAAcC,GACdI,EAAeJ,KAGhBT,EAAGI,KAAK,iEAAiEyB,YAAY,UAAWP,GAEjGtB,EAAGI,KAAK,oBAAoB6B,SAAS,UACrC9B,EAASS,YAAY,UAAUL,GAAG,QAAS,SAAU2B,GACpDA,EAAGC,iBACHD,EAAGE,oBAEJjC,EAASC,KAAK,SAASgB,IAAI,IAAIiB,QAAQ9B,GAAG,QAASY,GACnDA,MAGDnB,EAAGO,GAAG,mBAAoB,WACzBP,EAAGI,KAAK,oBAAoBQ,YAAY,UACxCT,EAAS8B,SAAS,UAAUK,IAAI,SAChCnC,EAASC,KAAK,SAASkC,IAAI,YAI7B,OAAOxC","file":"public/src/modules/categorySearch.js","sourcesContent":["'use strict';\n\ndefine('categorySearch', function () {\n\tvar categorySearch = {};\n\n\tcategorySearch.init = function (el) {\n\t\tif (utils.isTouchDevice()) {\n\t\t\treturn;\n\t\t}\n\t\tvar searchEl = el.find('[component=\"category-selector-search\"]');\n\t\tif (!searchEl.length) {\n\t\t\treturn;\n\t\t}\n\t\tvar categoryEls = el.find('[component=\"category/list\"] [data-cid]');\n\t\tel.on('show.bs.dropdown', function () {\n\t\t\tfunction revealParents(cid) {\n\t\t\t\tvar parentCid = el.find('[component=\"category/list\"] [data-cid=\"' + cid + '\"]').attr('data-parent-cid');\n\t\t\t\tif (parentCid) {\n\t\t\t\t\tel.find('[component=\"category/list\"] [data-cid=\"' + parentCid + '\"]').removeClass('hidden');\n\t\t\t\t\trevealParents(parentCid);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction revealChildren(cid) {\n\t\t\t\tvar els = el.find('[component=\"category/list\"] [data-parent-cid=\"' + cid + '\"]');\n\t\t\t\tels.each(function (index, el) {\n\t\t\t\t\tvar $el = $(el);\n\t\t\t\t\t$el.removeClass('hidden');\n\t\t\t\t\trevealChildren($el.attr('data-cid'));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction updateList() {\n\t\t\t\tvar val = searchEl.find('input').val().toLowerCase();\n\t\t\t\tvar noMatch = true;\n\t\t\t\tvar cids = [];\n\t\t\t\tcategoryEls.each(function () {\n\t\t\t\t\tvar liEl = $(this);\n\t\t\t\t\tvar isMatch = liEl.attr('data-name').toLowerCase().indexOf(val) !== -1;\n\t\t\t\t\tif (noMatch && isMatch) {\n\t\t\t\t\t\tnoMatch = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (isMatch && val) {\n\t\t\t\t\t\tcids.push(liEl.attr('data-cid'));\n\t\t\t\t\t}\n\t\t\t\t\tliEl.toggleClass('hidden', !isMatch).find('[component=\"category-markup\"]').css({ 'font-weight': val && isMatch ? 'bold' : 'normal' });\n\t\t\t\t});\n\n\t\t\t\tcids.forEach(function (cid) {\n\t\t\t\t\trevealParents(cid);\n\t\t\t\t\trevealChildren(cid);\n\t\t\t\t});\n\n\t\t\t\tel.find('[component=\"category/list\"] [component=\"category/no-matches\"]').toggleClass('hidden', !noMatch);\n\t\t\t}\n\t\t\tel.find('.dropdown-toggle').addClass('hidden');\n\t\t\tsearchEl.removeClass('hidden').on('click', function (ev) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t});\n\t\t\tsearchEl.find('input').val('').focus().on('keyup', updateList);\n\t\t\tupdateList();\n\t\t});\n\n\t\tel.on('hide.bs.dropdown', function () {\n\t\t\tel.find('.dropdown-toggle').removeClass('hidden');\n\t\t\tsearchEl.addClass('hidden').off('click');\n\t\t\tsearchEl.find('input').off('keyup');\n\t\t});\n\t};\n\n\treturn categorySearch;\n});\n"]}